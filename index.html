<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä¸­å›½èªå˜èª</title>
<style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    padding: 20px;
    max-width: 600px;
    margin: 0 auto;
    color: #2c3e50;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    min-height: 100vh;
}
h1 {
    font-size: 2.5em;
    margin-bottom: 30px;
    text-align: center;
    color: #34495e;
    text-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
ul {
    list-style-type: none;
    padding: 0;
}
ul li {
    margin-bottom: 15px;
    padding: 15px;
    background: linear-gradient(135deg, #ffffff 0%, #f5f3f0 100%);
    color: #2c3e50;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(52,73,94,0.1);
    border: 1px solid rgba(74,144,226,0.1);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 15px;
}
ul li:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(52,73,94,0.15);
    border-color: rgba(74,144,226,0.3);
}
.word-number {
    background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
    color: white;
    width: 35px;
    height: 35px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 0.9em;
    flex-shrink: 0;
}
.word-content {
    flex: 1;
}
.pronunciation {
    display: inline-block;
    vertical-align: bottom;
    margin-left: 5px;
}
.katakana {
    color: #95a5a6;
    font-size: 0.75em;
    display: block;
    line-height: 1;
    margin-bottom: 2px;
}
.pinyin {
    font-size: 0.9em;
    line-height: 1;
}
button {
    padding: 12px 20px;
    margin-left: 10px;
    font-size: 1em;
    background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
    color: #ffffff;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(74,144,226,0.3);
    transition: all 0.3s ease;
    font-weight: 500;
    min-height: 44px; /* iOSæ¨å¥¨ã®ã‚¿ãƒƒãƒã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚µã‚¤ã‚º */
    min-width: 44px;
    -webkit-tap-highlight-color: transparent;
}
button:hover {
    background: linear-gradient(135deg, #357abd 0%, #2e6da4 100%);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(74,144,226,0.4);
}
button:active {
    transform: translateY(0);
    box-shadow: 0 2px 6px rgba(74,144,226,0.3);
}
button:disabled {
    background: linear-gradient(135deg, #bdc3c7 0%, #95a5a6 100%);
    cursor: not-allowed;
    transform: none;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.error-message {
    color: #e74c3c;
    font-size: 0.9em;
    margin-top: 8px;
    display: none;
    font-weight: 500;
}
.success-message {
    color: #27ae60;
    font-size: 0.9em;
    margin-top: 8px;
    display: none;
    font-weight: 500;
}
.init-button {
    background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
    color: white;
    padding: 15px 30px;
    font-size: 1.1em;
    border: none;
    border-radius: 10px;
    margin: 20px auto;
    display: block;
    cursor: pointer;
    box-shadow: 0 3px 10px rgba(231,76,60,0.4);
    transition: all 0.3s ease;
    min-height: 50px;
    -webkit-tap-highlight-color: transparent;
}
.init-button:hover {
    background: linear-gradient(135deg, #c0392b 0%, #a93226 100%);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(231,76,60,0.5);
}
.init-button:active {
    transform: translateY(0);
}
.init-message {
    text-align: center;
    padding: 20px;
    background: rgba(231,76,60,0.1);
    border: 2px solid rgba(231,76,60,0.3);
    border-radius: 10px;
    margin-bottom: 20px;
    font-weight: 500;
    color: #c0392b;
}
@media (max-width: 600px) {
    body {
        padding: 15px;
    }
    h1 {
        font-size: 2em;
    }
    ul li {
        padding: 12px;
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
    }
    .word-number {
        width: 30px;
        height: 30px;
        font-size: 0.8em;
    }
    .word-content {
        width: 100%;
    }
    button {
        padding: 12px 16px;
        font-size: 0.9em;
        margin-left: 0;
        margin-top: 8px;
        display: block;
        width: 100%;
    }
    .pronunciation {
        display: block;
        margin-left: 0;
        margin-top: 5px;
    }
    .katakana {
        display: block;
        margin-bottom: 1px;
    }
    .pinyin {
        display: block;
    }
}
</style>
</head>
<body>
<h1>ä¸­å›½èªå˜èª</h1>

<div id="initSection" style="margin-bottom: 25px;">
    <div class="init-message">
        ğŸ“± <strong>iOS/iPhoneç”¨ï¼š</strong>éŸ³å£°ã‚’æœ‰åŠ¹ã«ã™ã‚‹ãŸã‚ã«ã€ã¾ãšä¸‹ã®ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ãã ã•ã„
    </div>
    <button class="init-button" id="initAudioBtn">ğŸ”Š éŸ³å£°ã‚’æœ‰åŠ¹ã«ã™ã‚‹</button>
</div>

<div style="margin-bottom: 25px; padding: 15px; background: linear-gradient(135deg, #ffffff 0%, #f5f3f0 100%); color: #2c3e50; border-radius: 10px; border: 1px solid rgba(74,144,226,0.2); box-shadow: 0 2px 8px rgba(52,73,94,0.08);">
    <strong style="color: #4a90e2;">ğŸ’¡ ä½¿ç”¨æ–¹æ³•ï¼š</strong>ãƒ–ãƒ©ã‚¦ã‚¶ã®éŸ³å£°åˆæˆæ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ä¸­å›½èªã‚’èª­ã¿ä¸Šã’ã¾ã™ã€‚
</div>

<ul id="wordsList"></ul>

<script>
const words = [
  {"chinese" : "ç¬¬" , "pinyin" : "dÃ¬" , "katakana" : "ãƒ‡ã‚£ãƒ¼" },
  {"chinese" : "ä¸€" , "pinyin" : "yÄ«" , "katakana" : "ã‚¤ãƒ¼" },
  {"chinese" : "è¯¾" , "pinyin" : "kÃ¨" , "katakana" : "ã‚¯ãƒ¼" },
  {"chinese" : "ä½ " , "pinyin" : "nÇ" , "katakana" : "ãƒ‹ãƒ¼" },
  {"chinese" : "å«" , "pinyin" : "jiÃ o" , "katakana" : "ã‚¸ãƒ£ã‚ª" },
  {"chinese" : "ä»€ä¹ˆ" , "pinyin" : "shÃ©nme" , "katakana" : "ã‚·ã‚§ãƒ³ãƒ ãƒ¼" },
  {"chinese" : "åå­—" , "pinyin" : "mÃ­ngzi" , "katakana" : "ãƒŸãƒ³ã‚ºãƒ¼" },
  {"chinese" : "ä½ å¥½" , "pinyin" : "nÇ hÇo" , "katakana" : "ãƒ‹ãƒ¼ãƒã‚ª" },
  {"chinese" : "è€å¸ˆ" , "pinyin" : "lÇoshi" , "katakana" : "ãƒ©ã‚ªã‚·ãƒ¼" },
  {"chinese" : "å¥½" , "pinyin" : "hÇo" , "katakana" : "ãƒã‚ª" },
  {"chinese" : "æˆ‘" , "pinyin" : "wÇ’" , "katakana" : "ã‚¦ã‚©ãƒ¼" },
  {"chinese" : "å¾ˆ" , "pinyin" : "hÄ›n" , "katakana" : "ãƒ˜ãƒ³" },
  {"chinese" : "å¥½å¬" , "pinyin" : "hÇotÄ«ng" , "katakana" : "ãƒã‚ªãƒ†ã‚£ãƒ³" },
  {"chinese" : "è°¢è°¢" , "pinyin" : "XiÃ¨xie" , "katakana" : "ã‚·ã‚¨ã‚·ã‚¨" },
  {"chinese" : "æ˜¯" , "pinyin" : "shÃ¬" , "katakana" : "ã‚·ãƒ¼" },
  {"chinese" : "ä¸­å›½" , "pinyin" : "ZhÅngguÃ³" , "katakana" : "ã‚¸ãƒ§ãƒ³ã‚°ã‚ª" },
  {"chinese" : "å“ªä¸ª" , "pinyin" : "nÇr" , "katakana" : "ãƒŠãƒ¼ãƒ«" },
  {"chinese" : "äºº" , "pinyin" : "rÃ©n" , "katakana" : "ãƒ¬ãƒ³" },
  {"chinese" : "è‹å·" , "pinyin" : "SÅ«zhÅu" , "katakana" : "ã‚¹ãƒ¼ã‚¸ãƒ§ã‚¦" },
  {"chinese" : "åœ°æ–¹" , "pinyin" : "dÃ¬fang" , "katakana" : "ãƒ‡ã‚£ãƒ¼ãƒ•ã‚¡ãƒ³" },
  {"chinese" : "æ‚¨å¥½" , "pinyin" : "NÃ­n hÇo" , "katakana" : "ãƒ‹ãƒ³ãƒã‚ª" },
  {"chinese" : "ä½ ä»¬å¥½" , "pinyin" : "NÇmen hÇo" , "katakana" : "ãƒ‹ãƒ¼ãƒ¡ãƒ³ãƒã‚ª" },
  {"chinese" : "å¤§å®¶å¥½" , "pinyin" : "DÃ jiÄ hÇo" , "katakana" : "ãƒ€ãƒ¼ã‚¸ãƒ£ãƒ¼ãƒã‚ª" },
  {"chinese" : "æ—©ä¸Šå¥½" , "pinyin" : "ZÇoshang hÇo" , "katakana" : "ã‚¶ã‚ªã‚·ãƒ£ãƒ³ãƒã‚ª" },
  {"chinese" : "ä¸‹åˆå¥½" , "pinyin" : "XiÃ wÇ” hÇo" , "katakana" : "ã‚·ãƒ£ãƒ¼ã‚¦ãƒ¼ãƒã‚ª" },
  {"chinese" : "æ™šä¸Šå¥½" , "pinyin" : "WÇnshang hÇo" , "katakana" : "ãƒ¯ãƒ³ã‚·ãƒ£ãƒ³ãƒã‚ª" },
  {"chinese" : "ä¸" , "pinyin" : "bÃ¹" , "katakana" : "ãƒ–ãƒ¼" },
  {"chinese" : "ä¸å®¢æ°”" , "pinyin" : "BÃº kÃ¨qi" , "katakana" : "ãƒ–ãƒ¼ã‚¯ãƒ¼ãƒãƒ¼" },
  {"chinese" : "ä¸ç”¨è°¢" , "pinyin" : "BÃº yÃ²ng xiÃ¨" , "katakana" : "ãƒ–ãƒ¼ãƒ¨ãƒ³ã‚·ã‚¨" },
  {"chinese" : "å¯¹ä¸èµ·" , "pinyin" : "DuÃ¬buqÇ" , "katakana" : "ãƒ‰ã‚¥ã‚¤ãƒ–ãƒãƒ¼" },
  {"chinese" : "æ²¡å…³ç³»" , "pinyin" : "MÃ©i guÄnxi" , "katakana" : "ãƒ¡ã‚¤ã‚°ã‚¢ãƒ³ã‚·ãƒ¼" },
  {"chinese" : "è¯·å¤šå…³ç…§" , "pinyin" : "QÇng duÅ guÄnzhÃ o" , "katakana" : "ãƒãƒ³ãƒ‰ã‚¥ã‚ªã‚°ã‚¢ãƒ³ã‚¸ãƒ£ã‚ª" },
  {"chinese" : "è¯·å¤šæŒ‡æ•™" , "pinyin" : "QÇng duÅ zhÇjiÄo" , "katakana" : "ãƒãƒ³ãƒ‰ã‚¥ã‚ªã‚¸ãƒ¼ã‚¸ãƒ£ã‚ª" },
  {"chinese" : "æ—¥æœ¬" , "pinyin" : "RÃ¬bÄ›n" , "katakana" : "ãƒªãƒ¼ãƒ™ãƒ³" },
  {"chinese" : "ä¸­å›½" , "pinyin" : "ZhÅngguÃ³" , "katakana" : "ã‚¸ãƒ§ãƒ³ã‚°ã‚ª" },
  {"chinese" : "éŸ©å›½" , "pinyin" : "HÃ¡nguÃ³" , "katakana" : "ãƒãƒ³ã‚°ã‚ª" },
  {"chinese" : "ç¾å›½" , "pinyin" : "MÄ›iguÃ³" , "katakana" : "ãƒ¡ã‚¤ã‚°ã‚ª" },
  {"chinese" : "è‹±å›½" , "pinyin" : "YÄ«ngguÃ³" , "katakana" : "ã‚¤ãƒ³ã‚°ã‚°ã‚ª" },
  {"chinese" : "å¾·å›½" , "pinyin" : "DÃ©guÃ³" , "katakana" : "ãƒ‰ã‚¥ãƒ¼ã‚°ã‚ª" },
  {"chinese" : "æ³•å›½" , "pinyin" : "FÇguÃ³" , "katakana" : "ãƒ•ã‚¡ãƒ¼ã‚°ã‚ª" },
  {"chinese" : "ä¿„ç½—æ–¯" , "pinyin" : "Ã‰luÃ³sÄ«" , "katakana" : "ã‚ªãƒ«ã‚ªã‚¹ãƒ¼" },
  {"chinese" : "æ‚¨" , "pinyin" : "nÃ­n" , "katakana" : "ãƒ‹ãƒ³" },
  {"chinese" : "è´µå§“" , "pinyin" : "guÃ¬xÃ¬ng" , "katakana" : "ã‚°ã‚¤ã‚·ãƒ³" },
  {"chinese" : "å“ª" , "pinyin" : "nÇ" , "katakana" : "ãƒŠãƒ¼" },
  {"chinese" : "å›½" , "pinyin" : "guÃ³" , "katakana" : "ã‚°ã‚ª" }
];

let audioContext;
let audioInitialized = false;

// éŸ³å£°åˆæˆæ©Ÿèƒ½ã®ä½¿ç”¨å¯èƒ½æ€§ã‚’ãƒã‚§ãƒƒã‚¯
const speechSynthesisSupported = 'speechSynthesis' in window;

// iOSéŸ³å£°åˆæœŸåŒ–
function initializeAudio() {
    try {
        // AudioContextã‚’ä½œæˆã—ã¦iOSã®éŸ³å£°ã‚’åˆæœŸåŒ–
        if (!audioContext) {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
        }
        
        // ç„¡éŸ³ã®éŸ³å£°ã‚’å†ç”Ÿã—ã¦iOSã®åˆ¶é™ã‚’è§£é™¤
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        gainNode.gain.setValueAtTime(0, audioContext.currentTime);
        oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
        oscillator.start();
        oscillator.stop(audioContext.currentTime + 0.01);
        
        // éŸ³å£°åˆæˆã‚‚åˆæœŸåŒ–
        if (speechSynthesisSupported) {
            const utterance = new SpeechSynthesisUtterance('');
            utterance.volume = 0;
            speechSynthesis.speak(utterance);
        }
        
        audioInitialized = true;
        document.getElementById('initSection').style.display = 'none';
        
    } catch (error) {
        console.log('Audio initialization error:', error);
    }
}

// ä¸­å›½èªéŸ³å£°ã‚’å–å¾—ã™ã‚‹é–¢æ•°
function getChineseVoice() {
    const voices = speechSynthesis.getVoices();
    return voices.find(voice => 
        voice.lang.includes('zh') || 
        voice.name.includes('Chinese') ||
        voice.name.includes('ä¸­æ–‡') ||
        voice.lang.includes('cmn')
    ) || voices[0];
}

// éŸ³å£°åˆæˆã§ä¸­å›½èªã‚’èª­ã¿ä¸Šã’ã‚‹é–¢æ•°
function speakChinese(text, button, errorDiv, successDiv) {
    if (!speechSynthesisSupported) {
        errorDiv.textContent = 'éŸ³å£°åˆæˆãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“';
        errorDiv.style.display = 'block';
        return;
    }
    
    if (!audioInitialized) {
        errorDiv.textContent = 'å…ˆã«ã€ŒéŸ³å£°ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ãã ã•ã„';
        errorDiv.style.display = 'block';
        return;
    }
    
    // æ—¢å­˜ã®éŸ³å£°ã‚’åœæ­¢
    speechSynthesis.cancel();
    
    button.disabled = true;
    button.textContent = 'å†ç”Ÿä¸­...';
    errorDiv.style.display = 'none';
    successDiv.style.display = 'none';
    
    // å°‘ã—å¾…ã£ã¦ã‹ã‚‰éŸ³å£°åˆæˆã‚’é–‹å§‹ï¼ˆiOSå¯¾ç­–ï¼‰
    setTimeout(() => {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'zh-CN';
        utterance.rate = 0.7;
        utterance.pitch = 1;
        utterance.volume = 1;
        
        // ä¸­å›½èªéŸ³å£°ã‚’è¨­å®š
        const chineseVoice = getChineseVoice();
        if (chineseVoice) {
            utterance.voice = chineseVoice;
        }
        
        utterance.onstart = () => {
            successDiv.textContent = 'å†ç”Ÿä¸­...';
            successDiv.style.display = 'block';
        };
        
        utterance.onend = () => {
            button.disabled = false;
            button.textContent = 'ğŸ”Š å†ç”Ÿ';
            successDiv.textContent = 'å†ç”Ÿå®Œäº†';
            setTimeout(() => {
                successDiv.style.display = 'none';
            }, 1500);
        };
        
        utterance.onerror = (event) => {
            button.disabled = false;
            button.textContent = 'ğŸ”Š å†ç”Ÿ';
            errorDiv.textContent = 'å†ç”Ÿã‚¨ãƒ©ãƒ¼: ' + event.error;
            errorDiv.style.display = 'block';
            console.log('Speech synthesis error:', event);
        };
        
        try {
            speechSynthesis.speak(utterance);
        } catch (error) {
            button.disabled = false;
            button.textContent = 'ğŸ”Š å†ç”Ÿ';
            errorDiv.textContent = 'éŸ³å£°å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸ';
            errorDiv.style.display = 'block';
            console.log('Speech error:', error);
        }
    }, 100);
}

// åˆæœŸåŒ–ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
document.getElementById('initAudioBtn').addEventListener('click', initializeAudio);

const list = document.getElementById('wordsList');

// éŸ³å£°ã®èª­ã¿è¾¼ã¿å®Œäº†ã‚’å¾…ã¤
function createWordList() {
    list.innerHTML = ''; // æ—¢å­˜ã®ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢
    
    words.forEach((word, index) => {
        const item = document.createElement('li');
        item.innerHTML = `
            <div class="word-number">${index + 1}</div>
            <div class="word-content">
                <div>
                    <strong style="font-size: 1.2em;">${word.chinese}</strong>
                    <span class="pronunciation">
                        <span class="katakana">${word.katakana}</span>
                        <span class="pinyin">(${word.pinyin})</span>
                    </span>
                    <button id="btn-${index}">ğŸ”Š å†ç”Ÿ</button>
                </div>
                <div class="error-message" id="error-${index}"></div>
                <div class="success-message" id="success-${index}"></div>
            </div>
        `;
        
        const button = item.querySelector(`#btn-${index}`);
        const errorDiv = item.querySelector(`#error-${index}`);
        const successDiv = item.querySelector(`#success-${index}`);
        
        button.addEventListener('touchstart', (e) => {
            e.preventDefault();
        }, { passive: false });
        
        button.addEventListener('click', (e) => {
            e.preventDefault();
            speakChinese(word.chinese, button, errorDiv, successDiv);
        });
        
        list.appendChild(item);
    });
}

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«éŸ³å£°ãƒªã‚¹ãƒˆã‚’ä½œæˆ
if (speechSynthesisSupported) {
    speechSynthesis.onvoiceschanged = createWordList;
}

// åˆæœŸãƒªã‚¹ãƒˆä½œæˆ
createWordList();

// ã‚¿ãƒƒãƒã‚¤ãƒ™ãƒ³ãƒˆã®è¨­å®šï¼ˆiOSå¯¾ç­–ï¼‰
document.addEventListener('touchstart', function() {}, {passive: true});
</script>
</body>
</html>
